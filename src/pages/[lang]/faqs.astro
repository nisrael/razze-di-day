---
import BaseLayout from "../../layouts/BaseLayout.astro";
import FAQItem from "../../components/FAQItem";
import { useTranslations } from "../../utils/i18n";
import { LOCALES } from "../../consts";
import FallbackBanner from "../../components/FallbackBanner.astro";
import { getLocalizedContent } from "../../utils/content";

export function getStaticPaths() {
  return LOCALES.map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
const t = useTranslations(lang);
const { entry: faqsEntry, isFallback } = await getLocalizedContent("faqs", lang);
const faqsData = faqsEntry?.data;
const faqs = faqsData?.items || [];
---

<BaseLayout
  lang={lang}
  title={`${t.nav.faqs} | Digital Independence Day`}
  description={faqsData?.desc}
>
  <!-- Schema.org FAQPage structured data -->
  <script
    type="application/ld+json"
    slot="head"
    set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "FAQPage",
      mainEntity: faqs.map((faq) => ({
        "@type": "Question",
        name: faq.question,
        acceptedAnswer: {
          "@type": "Answer",
          text: faq.answer,
        },
      })),
    })}
  />
  <div class="container mx-auto px-4 py-12 max-w-4xl">
    {isFallback && <FallbackBanner lang={lang} />}
    <header class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-display font-bold mb-4">
        {faqsData?.title}
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-400">
        {faqsData?.desc}
      </p>
    </header>

    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8">
      {
        faqs.map((faq) => (
          <FAQItem question={faq.question} answer={faq.answer} client:load />
        ))
      }
    </div>

    <div class="mt-12 text-center">
      <p class="text-gray-600 dark:text-gray-400 mb-4">
        {faqsData?.moreQuestions}
      </p>
    </div>
  </div>
</BaseLayout>
